import{ReadInProducts}from "../database/products.js";import{ChangeCartDisplay,RedirectToCheckout}from "../components/cart.js";import{LoadAppropriateButton}from "../components/accountButton.js";import{DisplayToast}from "../components/toast.js";(function(){DisplayBestSellers();LoadAppropriateButton();let cart=sessionStorage.getItem('cart');if(cart===null){cart=[];sessionStorage.setItem('cart',JSON.stringify(cart));console.log(JSON.parse(sessionStorage.getItem('cart')))}document.getElementById('cart-button').addEventListener('click',ChangeCartDisplay,false);document.getElementById('close-cart-button').addEventListener('click',ChangeCartDisplay,false);document.getElementById('checkout-button').addEventListener('click',GoToChekcout,false)}());async function DisplayBestSellers(){let products=await ReadInProducts();let bestsellingProducts=FilterForBestsellers(products);bestsellingProducts.map((product)=>{RenderProduct(product)})}function FilterForBestsellers(products){let bestsellers=[];products.map((product)=>{if((product.hasOwnProperty('bestseller'))&&(product.bestseller===true)){bestsellers.push(product)}});return bestsellers}function RenderProduct(product){let productCardsContainer=document.getElementById('products-container');let card=document.createElement('div');card.classList.add('product-card');card.onclick=function(){RedirectToProductDetails(this)};let image=document.createElement('img');image.classList.add('product-image');image.src=product.image_url;let body=document.createElement('div');body.classList.add('product-description');let productName=document.createElement('h2');productName.innerText=product.product_name;let productPrice=document.createElement('h3');productPrice.innerText=`â‚¬${product.price.toFixed(2)}`;body.appendChild(productName);body.appendChild(productPrice);card.appendChild(image);card.appendChild(body);productCardsContainer.appendChild(card)}function RedirectToProductDetails(productCard){let rawProductName=productCard.innerHTML;let parsedProductName=rawProductName.split('h2>');parsedProductName=parsedProductName[1].replace("</","");parsedProductName=parsedProductName.replaceAll(" ","-");let projectDetailsPage=`./product.html?${ parsedProductName }`;window.open(projectDetailsPage,"_self")}function GoToChekcout(){let cart=sessionStorage.getItem('cart');cart=JSON.parse(cart);let isLoggedIn=JSON.parse(sessionStorage.getItem('loggedIn'));if(cart.length===0){DisplayToast('No items in cart','e')}else if((cart.length>0)&&(isLoggedIn!==true)){window.location.href="./../html/sign-in.html"}else{RedirectToCheckout()}}